# 正規表現

## 定義

正規表現は文字列に特定部分の文字列が含まれているかどうかのどうかを確認します。ここでは、、一致した部分の文字列の置換や抽出に使用できる文字列一致パターンについて説明します。
Perlはマッチ.置換.転換の三つの演算子があります。この三つの演算子は常に結合演算子と一緒に使用します。

## 結合演算子

結合演算子の書き方は`=~`です、これはマッチするという意味です。マッチしないなら、書き方は`!~`です。

### 結合演算子の省略

`=~`の左側の変数はデフォルト`$_`です。デフォルトの場合には、左側の変数`$_`と結合演算子が省略できます。
例えば：

```Perl
if($_ =~ /a/){
 print"文字列にaがあります。";
}
```

を

```Perl
if(/a/){
 print"文字列にaがあります。";
}
```

に省略できます。

## マッチ演算子

前のような、`/a/`は左側の変数に一致するがどうかを判断したい部分、この部分はパターンと定義されています。`//`はマッチ演算子と呼ばれて、正式な記述方法は`m+区切り文字+パターン+区切り文字`です。デフォルトの区切り文字は`/`です、この場合には「m」が省略できます、`//`で表示します。区切り文字はその他の場合には「m」が省略出来ません、例えば、`m%%`で表示することもできます。
例えば

```Perl
my $moji = "Hello World";

if($moji =~ /Hello/){
 print"match";
}
```

と実行すると、結果は

```match
```

となります。

### マッチした部分文字列

マッチした後、三つ特殊変数が存在します：

* $`     マッチした部分の前の文字列
* $&　　　マッチした文字列
* $'　　　マッチした部分の後の文字列

これらの3つの変数を組み合わせると、元の文字列が得られます。

例えば：

```Perl
my $moji = "apple is 500yen";
$moji =~ m/is/;
print "マッチした部分の前の文字列: $`\n";
print "マッチした文字列: $&\n";
print "マッチした部分の後の文字列: $'\n";
```

と実行すると、結果は

```マッチした部分の前の文字列:apple
マッチした文字列:is
マッチした部分の後の文字列:500yen
```

## 置換演算子

置換演算子の書き方は

```Perl
s/置換元パターン/置換先パターン/;
```

です。

例えば

```Perl
my $moji = "Hello World";
$moji =~ s/World/Japan/;

print "$moji\n";
```

と実行すると、結果は

```Hello Japan
```

となります。

## 転換演算子

転換演算子の書き方は

```Perl
tr/転換元パターン/転換先パターン/;
```

例えば

```Perl
my $moji = "hello world";
$moji =~ tr/a-z/A-Z/;

print "$moji\n";
```

と実行すると、結果は

```HELLO WORLD
```

となります。

## 修飾子

修飾子を使ってパターンがマッチする時の動作を変更できます。使い方は`演算子の書き方+修飾子`です。たとえば、マッチ演算子使う時、もし大小文字を区別したくないなら、書き方は`m/パターン/i`です、この中の`/i`は大小文字を区別しないようにする修飾子です。
常に使う修飾子は以下のいくつかがあります：

* /i         大文字と小文字を区別せずにマッチする
* /x　　　　　パターン中のスペースやコメントを無視する
* /s　　　　　単一行モード
* /m　　　　　複数行モード
* /o　　　　　一回だけコンパイルをする
* /g　　　　　繰り返しマッチを行う
* cg　　　　　繰り返しマッチ失敗したら、もう一度パターンを探る
* /e　　　　　置換後の結果を式として行う

修飾子を複数扱うこともできます。たとえば`m/パターン/ix`は同時に`/i`と`/x`を扱います、このとき、`/i`と`/x`の二種類の修飾子の効能を使っています。

## 文字列の位置指定

文字列の位置を指定しないなら、マッチしたい文字列はどの位置でもマッチします。文字列の位置を指定してマッチしたい場合もありますので、指定方法は必要です。

* 「^」     文字列の先頭
* 「$」     文字列の末尾

これらの2つの方法を組み合わせると、元の文字列がマッチできます。
書き方は

```Perl
/^パターン/
/パターン$/
/^パターン$/
```

例えば

```Perl
my $moji1 = "apple is 500yen";
my $moji2 = "apple";

if ($moji1 =~ /^app/){
  print "文字列の先頭は「app」を含みます。¥n";
}else{
  print"文字列の先頭は「app」を含みません。¥n"
}
if ($moji1 =~ /is$/){
  print "文字列の末尾は「is」を含みます。¥n";
}else{
  print"文字列の末尾は「is」を含みません。¥n"
}
if ($moji2 =~ /^apple$/){
  print "文字列は「apple」です。¥n";
}else{
  print"文字列は「apple」ではありません。¥n"
}
```

と実行すると、結果は

```文字列の先頭は「app」を含みます。
文字列の末尾は「is」を含みません。
文字列は「apple」です。
```

となります。
